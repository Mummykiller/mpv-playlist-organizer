<!DOCTYPE html>
<html>
<head>
    <title>MPV Playlist Organizer</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <h1>MPV Playlist Organizer</h1>

    <!-- View 1: Mini Controller (shown when on-page UI is minimized) -->
    <div id="mini-controller-view" style="display: none;">
        <div class="control-group">
            <select id="mini-folder-select" title="Select active folder" style="flex-grow: 1;"></select>
            <button id="btn-mini-manage-folders" title="Manage Folders" style="flex-shrink: 0; padding: 8px; background-color: var(--surface-color);">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
            </button>
            <div id="mini-item-count-container" title="Items in playlist" style="flex-shrink: 0;">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
                <span id="mini-item-count">0</span>
            </div>
        </div>
        <div id="mini-controller-actions">
            <button id="btn-mini-add" title="Add Detected URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </button>
            <button id="btn-mini-play" title="Play Playlist">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
            </button>
            <button id="btn-mini-clear" title="Clear Playlist">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
            </button>
            <button id="btn-mini-close-mpv" title="Close MPV">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </button>
        </div>
        <div id="mini-folder-management-controls">
            <div class="control-group">
                <input type="text" id="mini-new-folder-name" placeholder="New folder name...">
                <button id="btn-mini-create-folder">Create</button>
            </div>
            <div class="control-group" style="margin-top: 12px;">
                <button id="btn-mini-remove-folder">Remove Selected Folder</button>
            </div>
            <div class="control-group" style="margin-top: 12px;">
                <label for="mini-geometry-select" style="white-space: nowrap; align-self: center; color: var(--text-secondary); font-weight: 500;">Window Size:</label>
                <select id="mini-geometry-select">
                    <option value="">Default</option>
                    <option value="640x360">Small (360p)</option>
                    <option value="1280x720">Medium (720p)</option>
                    <option value="1920x1080">HD (1080p)</option>
                    <option value="custom">Custom</option>
                </select>
            </div>
            <div id="mini-custom-geometry-container" class="control-group custom-geometry-container" style="display: none;">
                <input type="text" id="mini-custom-width" class="custom-geometry-input" placeholder="Width" pattern="[0-9]{1,4}" maxlength="4">
                <span class="custom-geometry-separator">&times;</span>
                <input type="text" id="mini-custom-height" class="custom-geometry-input" placeholder="Height" pattern="[0-9]{1,4}" maxlength="4">
            </div>
        </div>
        <button id="btn-show-on-page-controller" class="secondary-action">Show On-Page Controller</button>
    </div>

    <!-- View 2: Folder Management (default view) -->
    <div id="folder-management-view" style="display: none;">
        <div class="control-group">
            <input type="text" id="new-folder-name" placeholder="Create new folder...">
            <button id="btn-create-folder">Create</button>
        </div>
        <div class="control-group" style="margin-top: 12px;">
            <select id="remove-folder-select">
                <option value="">Select folder to remove...</option>
            </select>
            <button id="btn-remove-folder" disabled>Remove</button>
        </div>
        <div class="control-group" style="margin-top: 12px;">
            <label for="geometry-select" style="white-space: nowrap; align-self: center; color: var(--text-secondary); font-weight: 500;">Window Size:</label>
            <select id="geometry-select">
                <option value="">Default</option>
                <option value="640x360">Small (360p)</option>
                <option value="1280x720">Medium (720p)</option>
                <option value="1920x1080">HD (1080p)</option>
                <option value="custom">Custom</option>
            </select>
        </div>
        <div id="custom-geometry-container" class="control-group custom-geometry-container" style="display: none;">
            <input type="text" id="custom-width" class="custom-geometry-input" placeholder="Width" pattern="[0-9]{1,4}" maxlength="4">
            <span class="custom-geometry-separator">&times;</span>
            <input type="text" id="custom-height" class="custom-geometry-input" placeholder="Height" pattern="[0-9]{1,4}" maxlength="4">
        </div>
    </div>

    <div id="status-message"></div>

    <!-- Confirmation Modal for Popup -->
    <div id="popup-confirmation-modal" style="display: none;">
        <div class="modal-content">
            <p id="popup-modal-message"></p>
            <div class="modal-actions">
                <button id="popup-modal-confirm-btn">Confirm</button>
                <button id="popup-modal-cancel-btn">Cancel</button>
            </div>
        </div>
    </div>
    <script src="popup.js"></script>
</body>
</html>